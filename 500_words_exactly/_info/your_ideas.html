<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE-edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="imagetoolbar" content="no" />
    <!-- Bootstrap CDN server link -->
    <link href="../../_bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css">
    <link href="../main.css" rel="stylesheet">
    <link href="info.css" rel="stylesheet" type="text/css">
    <!-- Prevent caching -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <link rel="shortcut icon" href="../_story_images/coo.ico">

    <title>500 Words - Your Ideas</title>
</head>
<body>
    <div class="container text-center my-3">
        <h1>
          <a>
            <img src="../_story_images/500_title.png" alt="500_title" class="img-fluid" style="height:5%vh;">
          </a>
        </h1>
    </div>

    <div class="container text-center mb-3">
        <div class="button-container">
          <a href="../_info/500_words.html" class="btn btn-secondary mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="Learn more about 500 words">About 500 Words</a>
          <a href="../_info/foreward.html" class="btn btn-danger mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="A bit of an intro.">Foreward</a>
          <a href="../_info/acknowledgements.html" class="btn btn-warning mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="These people deserve some thanks.">Acknowledgements</a>
          <a href="../_info/cast1000.html" class="btn btn-primary mx-1 hover-effect-btn">Cast of a Thousand</a>
          <a href="../_info/random_story.html" class="btn btn-success mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="Complete pot luck.">Random Story</a>
          <!-- <a href="_info/add_your_own.php" class="btn btn-warning mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="Do you have an idea for a story?">Add your own Story</a> -->
          <a href="../_info/future_stuff.html" class="btn btn-warning mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="Things i'm working on">Future Stories</a>
          <a href="../" class="btn btn-primary mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="Return to main page">Return to main page</a>
        </div>
      </div>


    <div class="d-flex align-items-center justify-content-center below-header"> 
        <h1 class="mb-0">500 Words - Be Creative</h1>
    </div>
    
    <div class="scrollable-container">
        <div class="container my-2">
            <div style="text-align: left;">

              
              <main class="content" id="content">
                <!-- Content loaded via JavaScript will appear here -->
              </main>
              <button id="content">
                <button id="toggleButton" class="btn btn-primary mx-1 hover-effect-btn" data-bs-toggle="tooltip" title="Write your story">I'm ready to write my story.</button>
              </button>

              <div class="container mt-5" id="story_form">
                  <form id="storyForm">
                      <div class="form-row">
                          <div class="form-group col-md-6">
                              <label for="name">My name is:</label>
                              <input type="text" class="form-control" id="name" name="name" value="">
                          </div>
                          <div class="form-group col-md-6">
                              <label for="age">My age is:</label>
                              <input type="number" class="form-control" id="age" name="age" value="">
                          </div>
                      </div>
                      <div class="form-group">
                          <label for="title">My story is called:</label>
                          <textarea id="title" class="form-control" name="title">The name of my story is...</textarea>
                      </div> 
                      <div class="form-group">
                          <label for="idea">And this is my story:</label>
                          <textarea id="idea" class="form-control" name="idea">I have an idea and it starts like this...</textarea>
                      </div>    
                      <button type="submit" class="btn btn-primary">Save It! & Send It!</button>
                  </form>
              </div>
            </div>
        </div>
    </div>
    
    <div class="d-flex align-items-center justify-content-center"> 
        <a href="https://www.bbc.co.uk/teach/500-words" style="margin-right: 50px;">500 words - BBC</a>
        <a href="https://www.storycubes.com/en/">Rory's story cubes</a>
    </div>  

    <script>
        // When the document is loaded, fetch the text file and update the content
        document.addEventListener("DOMContentLoaded", function() {
            fetch("your_ideas.txt")
                .then(response => response.text())
                .then(data => {
                    // Convert newline characters to <br> tags
                    const contentWithBreaks = data.replace(/\n/g, "<br>");
                    document.getElementById("content").innerHTML = contentWithBreaks;
                })
                .catch(error => {
                    console.error("Error fetching the file:", error);
                    document.getElementById("content").innerHTML = "Failed to load content.";
                });
        });

        document.getElementById('storyForm').addEventListener('submit', function(e) {
          e.preventDefault(); // Prevent the form from submitting traditionally

          // Gather the form values
          const name = document.getElementById('name').value;
          const age = document.getElementById('age').value;
          const title = document.getElementById('title').value;
          const idea = document.getElementById('idea').value;

          // Create the text content for the file and email
          const content = `Name: ${name}\nAge: ${age}\nStory Title: ${title}\n\nStory:\n${idea}`;

          // Create a Blob for the file download
          const blob = new Blob([content], { type: 'text/plain' });
          const downloadLink = document.createElement('a');
          downloadLink.href = URL.createObjectURL(blob);
          // Use the story title as file name, trimming and replacing spaces if needed
          downloadLink.download = title.trim().replace(/\s+/g, '_') + '.txt';
          downloadLink.click();  // Trigger the download

          // Construct the mailto link with the content as the body
          const recipient = "bassjuggler@gmail.com"; // Replace with your email address
          const subject = title; // Or any subject you like
          const body = encodeURIComponent(content);

          // Create the mailto URL and open the default mail client
          const mailtoLink = `mailto:${recipient}?subject=${encodeURIComponent(subject)}&body=${body}`;
          window.location.href = mailtoLink;

          // Optionally, revoke the object URL after a delay to free memory
          setTimeout(() => {
              URL.revokeObjectURL(downloadLink.href);
          }, 100);
        });

        document.getElementById('toggleButton').addEventListener('click', function() {
          var mainContent = document.getElementById('content');
          var form = document.getElementById('story_form');

          if (mainContent.style.display === 'none') {
              mainContent.style.display = 'block';
              form.style.display = 'none';
          } else {
              mainContent.style.display = 'none';
              form.style.display = 'block';
          }
        });

    </script>
</body>
</html>
